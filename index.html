<!doctype html>
<html class="theme-next   use-motion ">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  <link href="/vendors/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css"/>




  <link href="//fonts.googleapis.com/css?family=Lato:300,400,700,400italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">



<link href="/vendors/font-awesome/css/font-awesome.min.css?v=4.4.0" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=0.4.5.2" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=0.4.5.2" />






<meta name="description" content="希望以后心情不好的时候可以全世界遛遛弯">
<meta property="og:type" content="website">
<meta property="og:title" content="CrystalMaidenRampage">
<meta property="og:url" content="http://solaxu.github.io/index.html">
<meta property="og:site_name" content="CrystalMaidenRampage">
<meta property="og:description" content="希望以后心情不好的时候可以全世界遛遛弯">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CrystalMaidenRampage">
<meta name="twitter:description" content="希望以后心情不好的时候可以全世界遛遛弯">



<script type="text/javascript" id="hexo.configuration">
  var CONFIG = {
    scheme: '',
    sidebar: 'always',
    motion: true
  };
</script>

  <title> CrystalMaidenRampage </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  <!--[if lte IE 8]>
  <div style=' clear: both; height: 59px; padding:0 0 0 15px; position: relative;margin:0 auto;'>
    <a href="http://windows.microsoft.com/en-US/internet-explorer/products/ie/home?ocid=ie6_countdown_bannercode">
      <img src="http://7u2nvr.com1.z0.glb.clouddn.com/picouterie.jpg" border="0" height="42" width="820"
           alt="You are using an outdated browser. For a faster, safer browsing experience, upgrade for free today or use other browser ,like chrome firefox safari."
           style='margin-left:auto;margin-right:auto;display: block;'/>
    </a>
  </div>
<![endif]-->
  






  <div class="container one-column 
   page-home 
">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">CrystalMaidenRampage</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle">Email-Me:solaxu@outlook.com</p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu ">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-home fa-fw"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-th fa-fw"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-archive fa-fw"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-tags fa-fw"></i> <br />
            
            标签
          </a>
        </li>
      

      
      
    </ul>
  

  
</nav>

 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div id="content" class="content">
          
  <section id="posts" class="posts-expand">

    

    
    

    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/22/Word-Search/" itemprop="url">
                  Word Search
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-03-22T12:11:43+08:00" content="2016-03-22">
              2016-03-22
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OJs/" itemprop="url" rel="index">
                    <span itemprop="name">OJs</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="Word_Search"><a href="#Word_Search" class="headerlink" title="Word Search"></a><strong>Word Search</strong></h1><hr>
<blockquote>
<p>Given a 2D board and a word, find if the word exists in the grid.</p>
<p>The word can be constructed from letters of sequentially adjacent cell, where “adjacent” cells are those horizontally or vertically neighboring. The same letter cell may not be used more than once.</p>
<p>For example,</p>
<p>Given board =<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line">  ['A','B','C','E'],</span><br><span class="line">  ['S','F','C','S'],</span><br><span class="line">  ['A','D','E','E']</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
<p>word = “ABCCED”, -&gt; returns true,</p>
<p>word = “SEE”, -&gt; returns true,</p>
<p>word = “ABCB”, -&gt; returns false.</p>
</blockquote>
<p>回溯。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">	<span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</span><br><span class="line">	<span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;vi&gt; vvi;</span><br><span class="line"></span><br><span class="line">	vvi vis;</span><br><span class="line">	<span class="keyword">int</span> index;</span><br><span class="line">	<span class="keyword">int</span>* rdir;</span><br><span class="line">	<span class="keyword">int</span>* cdir;</span><br><span class="line">	<span class="keyword">int</span> rows;</span><br><span class="line">	<span class="keyword">int</span> cols;</span><br><span class="line">	<span class="keyword">bool</span> result;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt;&gt;&amp; board, <span class="keyword">int</span> r, <span class="keyword">int</span> c, <span class="built_in">string</span>&amp; word)</span></span><br><span class="line">	</span>&#123;</span><br><span class="line">		vis[r][c] = <span class="literal">true</span>;</span><br><span class="line">		<span class="keyword">if</span> (word[index] == board[r][c])</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (result) <span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">if</span> (index == word.length() - <span class="number">1</span>) result = <span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> i = r - rdir[k];</span><br><span class="line">				<span class="keyword">int</span> j = c - cdir[k];</span><br><span class="line">				<span class="keyword">if</span> (i &gt;= <span class="number">0</span> &amp;&amp; i &lt; rows &amp;&amp; j &gt;= <span class="number">0</span> &amp;&amp; j &lt; cols &amp;&amp; vis[i][j] == <span class="number">0</span>)</span><br><span class="line">				&#123;</span><br><span class="line">					++index;</span><br><span class="line">					solve(board, i, j, word);</span><br><span class="line">					--index;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		vis[r][c] = <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">exist</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">char</span>&gt;&gt;&amp; board, <span class="built_in">string</span> word)</span> </span>&#123;</span><br><span class="line">		rows = board.size();</span><br><span class="line">		<span class="keyword">if</span> (rows == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		cols = board[<span class="number">0</span>].size();</span><br><span class="line">		<span class="keyword">if</span> (cols == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">		vis = vvi(rows, vi(cols, <span class="number">0</span>));</span><br><span class="line">		index = <span class="number">0</span>;</span><br><span class="line">		result = <span class="literal">false</span>;</span><br><span class="line">		<span class="keyword">int</span> rdirs[] = &#123; <span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>,-<span class="number">1</span> &#125;;</span><br><span class="line">		<span class="keyword">int</span> cdirs[] = &#123; <span class="number">1</span>,-<span class="number">1</span>,<span class="number">0</span>,<span class="number">0</span> &#125;;</span><br><span class="line">		rdir = rdirs;</span><br><span class="line">		cdir = cdirs;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; rows; ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cols; ++j)</span><br><span class="line">			&#123;</span><br><span class="line">				solve(board, i, j, word);</span><br><span class="line">				<span class="keyword">if</span> (result) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/21/Add-and-Search-Word-Data-structure-design/" itemprop="url">
                  Add and Search Word - Data structure design
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-03-21T19:19:04+08:00" content="2016-03-21">
              2016-03-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OJs/" itemprop="url" rel="index">
                    <span itemprop="name">OJs</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="Add_and_Search_Word_-_Data_structure_design"><a href="#Add_and_Search_Word_-_Data_structure_design" class="headerlink" title="Add and Search Word - Data structure design"></a><strong>Add and Search Word - Data structure design</strong></h1><hr>
<blockquote>
<p>Design a data structure that supports the following two operations:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">void <span class="function"><span class="title">addWord</span><span class="params">(word)</span></span></span><br><span class="line">bool <span class="function"><span class="title">search</span><span class="params">(word)</span></span></span><br></pre></td></tr></table></figure></p>
<p>search(word) can search a literal word or a regular expression string containing only letters a-z or .. A . means it can represent any one letter.</p>
<p>For example:<br><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">addWord</span><span class="params">(<span class="string">"bad"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">addWord</span><span class="params">(<span class="string">"dad"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">addWord</span><span class="params">(<span class="string">"mad"</span>)</span></span></span><br><span class="line"><span class="function"><span class="title">search</span><span class="params">(<span class="string">"pad"</span>)</span></span> -&gt; false</span><br><span class="line"><span class="function"><span class="title">search</span><span class="params">(<span class="string">"bad"</span>)</span></span> -&gt; true</span><br><span class="line"><span class="function"><span class="title">search</span><span class="params">(<span class="string">".ad"</span>)</span></span> -&gt; true</span><br><span class="line"><span class="function"><span class="title">search</span><span class="params">(<span class="string">"b.."</span>)</span></span> -&gt; true</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>回溯法解。注意需要剪枝，不然会超时。</p>
<p>首先上没有剪枝的版本，这个代码超时了：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> WordDictionary &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">	<span class="built_in">map</span>&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; datas;</span><br><span class="line">	<span class="comment">// Adds a word into the data structure.</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">addWord</span><span class="params">(<span class="built_in">string</span> word)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">auto</span> it = datas.find(word);</span><br><span class="line">		<span class="keyword">if</span> (it == datas.end())</span><br><span class="line">		&#123;</span><br><span class="line">			pair&lt;<span class="built_in">string</span>, <span class="keyword">int</span>&gt; p(word, <span class="number">1</span>);</span><br><span class="line">			datas.insert(p);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			it-&gt;second += <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Returns if the word is in the data structure. A word could</span></span><br><span class="line">	<span class="comment">// contain the dot character '.' to represent any one letter.</span></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">search</span><span class="params">(<span class="built_in">string</span> word)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">bool</span> r = <span class="literal">false</span>;</span><br><span class="line">		<span class="built_in">string</span> st;</span><br><span class="line">		solve(r, st, word, <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">bool</span>&amp; r, <span class="built_in">string</span>&amp; st, <span class="built_in">string</span>&amp; word, <span class="keyword">int</span> index)</span></span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> pos = index;</span><br><span class="line">		<span class="keyword">for</span> (; pos &lt; word.length(); ++pos)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (word[pos] == <span class="string">'.'</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			st.push_back(word[pos]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (st.length() == word.length())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (r == <span class="literal">false</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				r = (datas.find(st) != datas.end());</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="string">'a'</span>; i &lt;= <span class="string">'z'</span>; ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			st.push_back((<span class="keyword">char</span>)i);</span><br><span class="line">			solve(r, st, word, pos + <span class="number">1</span>);</span><br><span class="line">			<span class="keyword">if</span> (r) <span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">int</span> l = st.length() - pos;</span><br><span class="line">			<span class="keyword">while</span> (l &gt; <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				st.pop_back();</span><br><span class="line">				--l;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>然后是AC了的剪枝版本。剪枝过程使用了字典树，然后就是Check函数的三种返回值需要注意；字典树节点中的BOOL成员表明该字符是否属于一个字符串的终结字符。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> WordDictionary &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">	<span class="keyword">struct</span> Node</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">char</span> c;</span><br><span class="line">		<span class="keyword">bool</span> bstr;</span><br><span class="line">		Node* children[<span class="number">26</span>];</span><br><span class="line">		Node()</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i)</span><br><span class="line">				children[i] = <span class="literal">NULL</span>;</span><br><span class="line">			bstr = <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		Node(<span class="keyword">char</span> ch):c(ch)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; ++i)</span><br><span class="line">				children[i] = <span class="literal">NULL</span>;</span><br><span class="line">			bstr = <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;root;</span><br><span class="line">	<span class="comment">// Adds a word into the data structure.</span></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">addWord</span><span class="params">(<span class="built_in">string</span> word)</span> </span>&#123;</span><br><span class="line">		Node* pRoot = &amp;root;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; word.length(); ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (pRoot-&gt;children[word[i] - <span class="string">'a'</span>] == <span class="literal">NULL</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				pRoot-&gt;children[word[i] - <span class="string">'a'</span>] = <span class="keyword">new</span> Node(word[i]);</span><br><span class="line">			&#125;</span><br><span class="line">			pRoot = pRoot-&gt;children[word[i] - <span class="string">'a'</span>];</span><br><span class="line">			<span class="keyword">if</span> (i + <span class="number">1</span> == word.length())</span><br><span class="line">				pRoot-&gt;bstr = <span class="literal">true</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">check</span><span class="params">(<span class="built_in">string</span>&amp; s)</span></span><br><span class="line">	</span>&#123;</span><br><span class="line">		Node* pRoot = &amp;root;</span><br><span class="line">		Node* eNode = <span class="literal">NULL</span>;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			pRoot = pRoot-&gt;children[s[i] - <span class="string">'a'</span>];</span><br><span class="line">			<span class="keyword">if</span> (pRoot == <span class="literal">NULL</span>)</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">if</span> (i + <span class="number">1</span> == s.length())</span><br><span class="line">				eNode = pRoot;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (eNode-&gt;bstr) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">		<span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="comment">// Returns if the word is in the data structure. A word could</span></span><br><span class="line">	<span class="comment">// contain the dot character '.' to represent any one letter.</span></span><br><span class="line">	<span class="function"><span class="keyword">bool</span> <span class="title">search</span><span class="params">(<span class="built_in">string</span> word)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">bool</span> r = <span class="literal">false</span>;</span><br><span class="line">		<span class="built_in">string</span> st;</span><br><span class="line">		solve(r, st, word, <span class="number">0</span>);</span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">bool</span>&amp; r, <span class="built_in">string</span>&amp; st, <span class="built_in">string</span>&amp; word, <span class="keyword">int</span> index)</span></span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">int</span> pos = index;</span><br><span class="line">		<span class="keyword">for</span> (; pos &lt; word.length(); ++pos)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (word[pos] == <span class="string">'.'</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			st.push_back(word[pos]);</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (st.length() == word.length())</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (r == <span class="literal">false</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				r =  (<span class="number">1</span> == check(st));</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="string">'a'</span>; i &lt;= <span class="string">'z'</span>; ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			st.push_back((<span class="keyword">char</span>)i);</span><br><span class="line">			<span class="keyword">if</span> (<span class="number">0</span> == check(st))</span><br><span class="line">			&#123;</span><br><span class="line">				st.pop_back();</span><br><span class="line">				<span class="keyword">continue</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			solve(r, st, word, pos + <span class="number">1</span>);</span><br><span class="line">			<span class="keyword">if</span> (r) <span class="keyword">return</span>;</span><br><span class="line">			<span class="keyword">int</span> l = st.length() - pos;</span><br><span class="line">			<span class="keyword">while</span> (l &gt; <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				st.pop_back();</span><br><span class="line">				--l;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/21/Unique-Binary-Search-Trees/" itemprop="url">
                  Unique Binary Search Trees
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-03-21T13:39:11+08:00" content="2016-03-21">
              2016-03-21
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OJs/" itemprop="url" rel="index">
                    <span itemprop="name">OJs</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="Unique_Binary_Search_Trees"><a href="#Unique_Binary_Search_Trees" class="headerlink" title="Unique Binary Search Trees"></a><strong>Unique Binary Search Trees</strong></h1><hr>
<blockquote>
<p>Given n, how many structurally unique BST’s (binary search trees) that store values 1…n?</p>
<p>For example,</p>
<p>Given n = 3, there are a total of 5 unique BST’s.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>         <span class="number">3</span>     <span class="number">3</span>      <span class="number">2</span>      <span class="number">1</span></span><br><span class="line"> \       /     /      / \      \</span><br><span class="line">  <span class="number">3</span>     <span class="number">2</span>     <span class="number">1</span>      <span class="number">1</span>   <span class="number">3</span>      <span class="number">2</span></span><br><span class="line"> /     /       \                 \</span><br><span class="line"><span class="number">2</span>     <span class="number">1</span>         <span class="number">2</span>                 <span class="number">3</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>比较像矩阵链乘：取不同的分界点作为根，求两边的子树数量的乘积。</p>
<p>递归形式的AC代码，对迭代递推还是不够熟练：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; DP;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> begin, <span class="keyword">int</span> end)</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (begin &gt;= end) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (DP[begin][end]) <span class="keyword">return</span> DP[begin][end];</span><br><span class="line">        <span class="keyword">int</span> f = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = begin; i &lt;= end; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> r = solve(begin,i-<span class="number">1</span>);</span><br><span class="line">            <span class="keyword">int</span> l = solve(i+<span class="number">1</span>,end);</span><br><span class="line">            f += r * l;</span><br><span class="line">        &#125;</span><br><span class="line">        DP[begin][end] = f;</span><br><span class="line">        <span class="keyword">return</span> f;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numTrees</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="number">1</span> &gt;= n) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        DP = <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;(n+<span class="number">1</span>,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n+<span class="number">1</span>,<span class="number">0</span>));</span><br><span class="line">        solve(<span class="number">1</span>,n);</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> DP[<span class="number">1</span>][n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/20/Counting-Bits/" itemprop="url">
                  Counting Bits
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-03-20T20:10:53+08:00" content="2016-03-20">
              2016-03-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OJs/" itemprop="url" rel="index">
                    <span itemprop="name">OJs</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="Counting_Bits"><a href="#Counting_Bits" class="headerlink" title="Counting Bits"></a><strong>Counting Bits</strong></h1><hr>
<blockquote>
<p>Given a non negative integer number num. For every numbers i in the range 0 ≤ i ≤ num calculate the number of 1’s in their binary representation and return them as an array.</p>
<p>Example:</p>
<p>For num = 5 you should return [0,1,1,2,1,2].</p>
</blockquote>
<p>关键点在于找出数字二进制之间的关系：15 = 8 + 7，20 = 16 + 4这样</p>
<p>AC代码：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; countBits(<span class="keyword">int</span> num) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; DP(num+<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">        DP[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        DP[<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">3</span>; i &lt;= num; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> k = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span>(k &lt;= i)</span><br><span class="line">            &#123;</span><br><span class="line">                k *= <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            k /= <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> l = i - k;</span><br><span class="line">            <span class="keyword">if</span> (l == <span class="number">0</span>) DP[i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> DP[i] = DP[k] + DP[l];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> DP;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/20/Coin-Change/" itemprop="url">
                  Coin Change
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-03-20T17:05:47+08:00" content="2016-03-20">
              2016-03-20
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OJs/" itemprop="url" rel="index">
                    <span itemprop="name">OJs</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="Coin_Change"><a href="#Coin_Change" class="headerlink" title="Coin Change"></a><strong>Coin Change</strong></h1><hr>
<blockquote>
<p>You are given coins of different denominations and a total amount of money amount. Write a function to compute the fewest number of coins that you need to make up that amount.</p>
<p>If that amount of money cannot be made up by any combination of the coins, return -1.</p>
<p>Example 1:</p>
<p>coins = [1, 2, 5], amount = 11<br>return 3 (11 = 5 + 5 + 1)</p>
<p>Example 2:</p>
<p>coins = [2], amount = 3<br>return -1.</p>
<p>Note:<br>You may assume that you have an infinite number of each kind of coin.</p>
</blockquote>
<p>有向无环图上的最短路问题：给定一个出发点，求它到所有叶子节点的路径中最短的那条路径的长度。</p>
<p>AC代码：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> rest,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; coins, <span class="keyword">int</span> amount, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; DP)</span></span><br><span class="line">	</span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (rest == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (rest &lt; <span class="number">0</span>) <span class="keyword">return</span> amount+<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (DP[rest] &gt;= <span class="number">0</span>) <span class="keyword">return</span> DP[rest];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> r = amount + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; coins.size(); ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> s = solve(rest - coins[i], coins, amount, DP) + <span class="number">1</span>;</span><br><span class="line">			<span class="keyword">if</span> (s &lt; r) r = s;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		DP[rest] = r;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">coinChange</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; coins, <span class="keyword">int</span> amount)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (<span class="number">0</span> == amount) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="number">0</span> == coins.size()) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; DP(amount+<span class="number">1</span>,-<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">int</span> r = solve(amount,coins,amount,DP);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (r &gt; amount) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">return</span> r;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>非递归形式：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">	<span class="function"><span class="keyword">int</span> <span class="title">coinChange</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; coins, <span class="keyword">int</span> amount)</span> </span>&#123;</span><br><span class="line">		<span class="keyword">if</span> (<span class="number">0</span> == amount) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">		<span class="keyword">if</span> (<span class="number">0</span> == coins.size()) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">		<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; DP(amount + <span class="number">1</span>, INT_MAX);</span><br><span class="line">		DP[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; coins.size(); ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= amount ; ++j)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span> (j &gt;= coins[i] &amp;&amp; DP[j - coins[i]] != INT_MAX)</span><br><span class="line">				&#123;</span><br><span class="line">					DP[j] = min(DP[j], DP[j-coins[i]]+<span class="number">1</span>);</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span> (DP[amount] &gt; amount) <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">		<span class="keyword">return</span> DP[amount];</span><br><span class="line">	&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/19/0-1背包，完全背包，树形DP入门/" itemprop="url">
                  0-1背包，完全背包，树形DP入门
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-03-19T15:40:14+08:00" content="2016-03-19">
              2016-03-19
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OJs/" itemprop="url" rel="index">
                    <span itemprop="name">OJs</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="u524D_u9762"><a href="#u524D_u9762" class="headerlink" title="前面"></a><strong>前面</strong></h1><hr>
<p>关于算法这一块，怎么说呢，目前为止我还是比较盲目的在OJ上面A水题，但即便如此AC率也很低——这到底还是不行的，不过终究是给自己探了个底子——在仅有基础概念的RAW状态下能走多远。</p>
<p>就目前来看，很多时候问题出在自己见得少，给不出思路。对于抽象思维要求不高的题目，知道怎么去做之后多数情况还下是能够拿到TLE（并非纯暴搜导致）或者AC的——当然TLE也不是算过，终究还是代码技巧不足；而对于需要有较高抽象能力的题目，或是比较Tricky的题目，则力有不逮——一个是因为见得少而不知道怎么下手，再就是抽象思维能力不过关。</p>
<p>因此，就算法这块，现在开始进行专项练习吧。咱对自己的要求不高，也不指望能有ACM的程度，但至少买的那三本书：《算法竞赛入门经典》、《算法竞赛入门经典训练指南》以及《挑战程序设计竞赛》不能白瞎了。</p>
<p>由于不知道自己对《刷油漆》那道题的题解理解正确与否，文中对那道题目的讲解我是没有信心的，虽然最终代码是AC了……还是要多做多体会。</p>
<h1 id="u6B63_u6587"><a href="#u6B63_u6587" class="headerlink" title="正文"></a><strong>正文</strong></h1><hr>
<p>今次就看三个问题吧，从老生常谈的背包问题开始，到树形DP的简单介绍。</p>
<p>这里先推荐<a href="https://www.zhihu.com/question/23995189" target="_blank" rel="external">知乎上面关于DP的回答</a>看一看，两个高票答案已经将DP的核心问题讲得很明白了：就是“如何定义状态”以“如何控制状态的转移”——状态转移方程集中体现此两者，至于如何求解（递推或者是记忆化搜索）都只是求解方程的手段而已。</p>
<p>在谨记上面的条款之后，下面开始看3个题目，以协助理解。</p>
<h2 id="0-1_u80CC_u5305_u95EE_u9898"><a href="#0-1_u80CC_u5305_u95EE_u9898" class="headerlink" title="0-1背包问题"></a><strong><a href="http://hihocoder.com/contest/hiho6/problems" target="_blank" rel="external">0-1背包问题</a></strong></h2><p>From：HiHoCoder，HiHo一下第6周。</p>
<p>老题，网上有很多讲解的，包括状态方程怎么来的一应俱全，这里不去赘述，直接给AC的代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; vi;</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> INT_MAX <span class="number">2147483647</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> INT_MIN (-INT_MAX - <span class="number">1</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> N = <span class="number">0</span>, M = <span class="number">0</span>;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (N &lt;= <span class="number">0</span> || M &lt;= <span class="number">0</span>) &#123; <span class="built_in">cout</span> &lt;&lt; <span class="number">0</span> &lt;&lt; endl; <span class="keyword">return</span> <span class="number">0</span>; &#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">vector</span>&lt;vi&gt; dp(N + <span class="number">1</span>, vi(M + <span class="number">1</span>, <span class="number">0</span>));</span><br><span class="line">	<span class="function">vi <span class="title">need</span><span class="params">(N + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">	<span class="function">vi <span class="title">value</span><span class="params">(N + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; need[i] &gt;&gt; value[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span> result = INT_MIN;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= M; ++j)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (j &lt; need[i])</span><br><span class="line">			&#123;</span><br><span class="line">				dp[i][j] = dp[i - <span class="number">1</span>][j];</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> a = dp[i - <span class="number">1</span>][j];</span><br><span class="line">				<span class="keyword">int</span> b = dp[i - <span class="number">1</span>][j - need[i]] + value[i];</span><br><span class="line">				dp[i][j] = (a&gt;b) ? a : b;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (dp[i][j] &gt; result)</span><br><span class="line">			&#123;</span><br><span class="line">				result = dp[i][j];</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; result &lt;&lt; endl;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>需要注意一下：关于剩余空间M的For循环是从1开始加一递增的；而在采用记忆化搜索的递归解法中，剩余空间M并非是逐1递减的。这里需要逐步领会如何将尾递归转换为迭代的形式（PS：并非是指用显示Stack来辅助的方法）。</p>
<h2 id="u5B8C_u5168_u80CC_u5305_u95EE_u9898"><a href="#u5B8C_u5168_u80CC_u5305_u95EE_u9898" class="headerlink" title="完全背包问题"></a><strong><a href="http://hihocoder.com/contest/hiho7/problems" target="_blank" rel="external">完全背包问题</a></strong></h2><p>From： HiHoCoder，HiHo一下第7周。</p>
<p>题解HiHo上面已经有了，这里不赘述。下面的AC代码中并没有进行第二步的优化阶段：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> VALUE[<span class="number">501</span>];</span><br><span class="line"><span class="keyword">int</span> NEED[<span class="number">501</span>];</span><br><span class="line"><span class="keyword">int</span> N, W;</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> INT_MAX <span class="number">2147483647</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> INT_MIN (-INT_MAX - <span class="number">1</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; W;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; NEED[i + <span class="number">1</span>] &gt;&gt; VALUE[i + <span class="number">1</span>];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">int</span>** DP = (<span class="keyword">int</span>**)<span class="keyword">new</span> <span class="keyword">int</span>*[N + <span class="number">1</span>];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> m = <span class="number">0</span>; m &lt;= N; ++m)</span><br><span class="line">	&#123;</span><br><span class="line">		DP[m] = <span class="keyword">new</span> <span class="keyword">int</span>[W + <span class="number">1</span>];</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> n = <span class="number">0</span>; n &lt;= W; ++n)</span><br><span class="line">		&#123;</span><br><span class="line">			DP[m][n] = <span class="number">0</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= W; j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">int</span> K = j / NEED[i];</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt;= K; k++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> r = DP[i - <span class="number">1</span>][j - k*NEED[i]] + k * VALUE[i];</span><br><span class="line">				<span class="keyword">if</span> (DP[i][j] &lt; r) DP[i][j] = r;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; DP[N][W];</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="u5237_u6CB9_u6F06_uFF08_u6811_u5F62DP_uFF09"><a href="#u5237_u6CB9_u6F06_uFF08_u6811_u5F62DP_uFF09" class="headerlink" title="刷油漆（树形DP）"></a><strong><a href="http://hihocoder.com/contest/hiho12/problems" target="_blank" rel="external">刷油漆（树形DP）</a></strong></h2><p>From：HiHoCoder，HiHo一下第12周</p>
<p>虽然HiHo有给出题解，但是还是这里还是先借用《训练指南》P70的例题30的讲解开始吧——至少，对于我这种比较笨的人，HiHo的那个题解后半部分一开始是看不太懂的。</p>
<p>当然例题30并非是《刷油漆》原题，但也是树形DP的应用。</p>
<p>下面是整理的引用，需要注意的是后面两句：</p>
<blockquote>
<p>无向无环图，或者称为森林，有多棵树组成，动态规划是解决树上的优化问题的常用工具。</p>
<p>为了能够使用动态规划，这要求：森林中的每个节点都互不相干，以便可以单独优化。</p>
<p>我们只考虑一棵树的情况：首先对这棵树进行DFS，将无根树转化为有根树，然后试着设置，并计算它的状态。</p>
</blockquote>
<p>我们来看看单独的一棵树的情况，状态的定义HiHo题解中已经说明了，这里主要说明状态转移是如何发生的，也就是HiHo题解后半部分究竟是怎么回事。</p>
<p>先看给出的由case构造出来的树：</p>
<p><img src="http://ww4.sinaimg.cn/mw690/006lhMttgw1f22ahu9lvtj30ej0cgq3j.jpg" alt="case"></p>
<p>就从以节点4为根的子树开始吧。</p>
<p>显然我们要在这棵子树中选择三个节点，而如果想要对这棵子树进行评估，那么很显然，节点4也必须被选择（于是我们的DFS也就进行了2层了）。</p>
<p>剩下的两个节点只有从节点4的子树中选取了。</p>
<p>类比背包问题，这就相当于背包只剩下两个空间，而每个节点占用一个空间，选取的物品价值就相当于节点的最大估值，但这个值是存在于DP数组中的，并非是给定的值。</p>
<p>那么，对于节点4的每一个子树，都有可能分配0~2个空间。</p>
<p>这里应当注意：由于采用了DFS，我们已经把节点4的所有子树对应的状态都计算好了，因此，可以认为我们是在背包空间为2的情况下选取下面几个值来达到要求的最大值：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">DP[<span class="link_label">8</span>][<span class="link_reference">0</span>], DP[<span class="link_label">8</span>][<span class="link_reference">1</span>], DP[<span class="link_label">8</span>][<span class="link_reference">2</span>]</span><br><span class="line">DP[<span class="link_label">6</span>][<span class="link_reference">0</span>], DP[<span class="link_label">6</span>][<span class="link_reference">1</span>], DP[<span class="link_label">6</span>][<span class="link_reference">2</span>]</span><br><span class="line">DP[<span class="link_label">7</span>][<span class="link_reference">0</span>], DP[<span class="link_label">7</span>][<span class="link_reference">1</span>], DP[<span class="link_label">7</span>][<span class="link_reference">2</span>]</span><br></pre></td></tr></table></figure>
<p>类比完全背包问题：完全背包问题要求对于每种物品选取K个，来得到最大值。这里可以认为是：对于子节点8，选取0~2个；对于子节点6，选取0~2个；对于子节点7，选取0~2个。</p>
<p>这里需要注意的是，上面关于如何选择的情况均是在自顶向下的情况下说明的——而实际代码中，采用的是自底向上的填充方式。</p>
<p>在完全背包中，状态转移方程以及对应代码为：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">DP[<span class="link_label">i</span>][<span class="link_reference">j</span>] = max&#123; DP[<span class="link_label">i</span>][<span class="link_reference">j</span>], DP[<span class="link_label">i-1</span>][<span class="link_reference"> j-k*w[i</span>] ] + k*v[i] | k = [0...j/w[i]] &#125;</span><br><span class="line"></span><br><span class="line">for (int i = 1; i <span class="xml"><span class="tag">&lt;<span class="title">=</span> <span class="attribute">N</span>; ++<span class="attribute">i</span> )</span><br><span class="line">&#123;</span><br><span class="line">  <span class="attribute">for</span> (<span class="attribute">int</span> <span class="attribute">j</span> = <span class="attribute">1</span>; <span class="attribute">j</span> &lt;= <span class="attribute">M</span>; ++<span class="attribute">j</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attribute">int</span> <span class="attribute">K</span> = <span class="attribute">j</span>/<span class="attribute">w</span>[<span class="attribute">i</span>];</span><br><span class="line">    <span class="attribute">for</span> (<span class="attribute">int</span> <span class="attribute">k</span> = <span class="attribute">0</span>; <span class="attribute">k</span> &lt;= <span class="attribute">K</span>; ++<span class="attribute">k</span>)</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attribute">int</span> <span class="attribute">r</span> = <span class="attribute">DP</span>[<span class="attribute">i-1</span>][<span class="attribute">j-k</span>*<span class="attribute">w</span>[<span class="attribute">i</span>]]+<span class="attribute">k</span>*<span class="attribute">v</span>[<span class="attribute">i</span>];</span><br><span class="line">      <span class="attribute">if</span> (<span class="attribute">r</span> &gt;</span></span> DP[<span class="link_label">i</span>][<span class="link_reference">j</span>]) DP[<span class="link_label">i</span>][<span class="link_reference">j</span>] = r;</span><br><span class="line"><span class="code">    &#125;</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>那么，类比可以写出对于单个节点的DP值计算式：</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DP[<span class="link_label">i</span>][<span class="link_reference">j</span>] = max&#123; DP[<span class="link_label">i</span>][<span class="link_reference">j</span>], DP[<span class="link_label">i</span>][<span class="link_reference">j-k</span>] + DP[<span class="link_label">l</span>][<span class="link_reference">k</span>] | l = [i的子节点] &#125;</span><br></pre></td></tr></table></figure>
<p>举个栗子：<br><figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DP[<span class="link_label">4</span>][<span class="link_reference">3</span>] = DP[<span class="link_label">4</span>][<span class="link_reference">2</span>] + DP[<span class="link_label">6</span>][<span class="link_reference">1</span>]</span><br><span class="line"><span class="code">         = max&#123;</span></span><br><span class="line"><span class="code">                  (DP[4][1] + DP[8][1]),</span></span><br><span class="line"><span class="code">                  “DP[4][1] + DP[6][1],”</span></span><br><span class="line"><span class="code">                  (DP[4][1] + DP[7][1])</span></span><br><span class="line"><span class="code">              &#125; + DP[6][1]  </span></span><br><span class="line"></span><br><span class="line">// 显然max&#123;...&#125;中的DP[<span class="link_label">6</span>][<span class="link_reference">1</span>]是不应该重复计算的</span><br></pre></td></tr></table></figure></p>
<p>注意，完全背包的填充方式是在已经有的结果上再装上k个第i种物品（也就是剩余的空间还足够在第i中物品上做出多个选择）；而在当前问题中我们则是在选择了当前子树中的k个节点之后，根节点上还可以再选择多少个其他子树中的节点。</p>
<p>那么尝试写出代码：</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">DFS(int i, int <span class="keyword">M</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment">//vis[ci] = true;</span></span><br><span class="line">  <span class="keyword">for</span> (each child <span class="keyword">ci</span> of node i)</span><br><span class="line">  &#123;</span><br><span class="line">      <span class="comment">// 不对已经计算过的节点重复计算。</span></span><br><span class="line">      <span class="keyword">if</span> (vis[<span class="keyword">ci</span>]) <span class="keyword">continue</span>;</span><br><span class="line">      <span class="comment">// 先DFS计算子树</span></span><br><span class="line">      DFS(<span class="keyword">ci</span>,<span class="keyword">M</span>-1);</span><br><span class="line">      <span class="comment">// 然后根据子树，计算当前节点</span></span><br><span class="line">      <span class="keyword">for</span> ( <span class="keyword">m</span> = [<span class="keyword">M</span> ... 2]) <span class="comment">// 对于 “剩余空间” m</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">for</span> ( k = [1 ... <span class="keyword">m</span>] ) <span class="comment">// 接下来要取 k 个节点</span></span><br><span class="line">        &#123;</span><br><span class="line">          int r = DP[i][<span class="keyword">m</span>-k] + DP[<span class="keyword">ci</span>][k];</span><br><span class="line">          <span class="keyword">if</span> (r &gt; DP[i][<span class="keyword">m</span>]) DP[i][<span class="keyword">m</span>] = r;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>注意到M的值是从大到小计算的，这一点可以从前面列举的那个小例子中看出来：M值大的DP值是依赖于M值小的DP值的。而M的值最小只到2，原因在于，对于M=0时肯定为0，M=1时，就是节点本身。</p>
<p>下面是我的AC代码：</p>
<p>另：如果在HiHo一下的比赛排名中查找AC代码的话，会发现有关于edge、vis数组这样的东西，这是因为那些代码是基于无向图的，需要使用vis数组来标记节点以防止出现环的问题。大部分ACM相关的博客上也是此类型的代码，此类代码更具普适性。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;fstream&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> N, M;</span><br><span class="line"><span class="keyword">int</span> V[<span class="number">101</span>];</span><br><span class="line"><span class="keyword">int</span> vis[<span class="number">101</span>];</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> INT_MAX <span class="number">2147483647</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> INT_MIN (-INT_MAX - <span class="number">1</span>)</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; Tree[<span class="number">101</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> DP[<span class="number">101</span>][<span class="number">101</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">solve</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> m)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; children = Tree[n];</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">auto</span> ci = <span class="number">0</span>; ci &lt; children.size(); ++ci)</span><br><span class="line">	&#123;</span><br><span class="line">		solve(children[ci], m - <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> j = m; j &gt;= <span class="number">2</span>; --j)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">1</span>; k &lt; j; ++k)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">int</span> r = DP[n][j - k] + DP[children[ci]][k];</span><br><span class="line">				<span class="keyword">if</span> (r &gt; DP[n][j]) DP[n][j] = r;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="comment">// 注意下面的不要删除，重定向io流</span></span><br><span class="line">	<span class="comment">// std::ifstream in("in.txt");</span></span><br><span class="line">	<span class="comment">// std::streambuf* cinbuf = std::cin.rdbuf(); //save old buf</span></span><br><span class="line">	<span class="comment">// std::cin.rdbuf(in.rdbuf()); //redirect std::cin to in.txt!</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//</span></span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; M;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i) <span class="built_in">cin</span> &gt;&gt; V[i];</span><br><span class="line">	<span class="keyword">int</span> a, b;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; N; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b;</span><br><span class="line">		Tree[a].push_back(b);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= N; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		DP[i][<span class="number">1</span>] = V[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	solve(<span class="number">1</span>, M);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">cout</span> &lt;&lt; DP[<span class="number">1</span>][M] &lt;&lt; endl;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/11/优化延迟/" itemprop="url">
                  优化延迟
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-03-11T20:02:53+08:00" content="2016-03-11">
              2016-03-11
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OJs/" itemprop="url" rel="index">
                    <span itemprop="name">OJs</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="u4F18_u5316_u5EF6_u8FDF"><a href="#u4F18_u5316_u5EF6_u8FDF" class="headerlink" title="优化延迟"></a><strong>优化延迟</strong></h1><hr>
<p>From：<a href="http://hihocoder.com/contest/hihointerview3" target="_blank" rel="external">[Offer收割]编程练习赛1</a></p>
<blockquote>
<p>描述<br>小Ho编写了一个处理数据包的程序。程序的输入是一个包含N个数据包的序列。每个数据包根据其重要程度不同，具有不同的”延迟惩罚值”。序列中的第i个数据包的”延迟惩罚值”是Pi。如果N个数据包按照<pi1, pi2,="" ...="" pin="">的顺序被处理，那么总延迟惩罚</pi1,></p>
<p>SP=1*Pi1+2*Pi2+3*Pi3+…+N*PiN（其中i1, i2, … iN是1, 2, 3, … N的一个排列)。</p>
<p>小Ho的程序会依次处理每一个数据包，这时N个数据包的总延迟惩罚值SP为</p>
<p>1 * P1+2 * P2+3 * P3+…+i * Pi+…+N * PN。  </p>
<p>小Hi希望可以降低总延迟惩罚值。他的做法是在小Ho的程序中增加一个大小为K的缓冲区。N个数据包在被处理前会依次进入缓冲区。当缓冲区满的时候会将当前缓冲区内”延迟惩罚值”最大的数据包移出缓冲区并进行处理。直到没有新的数据包进入缓冲区时，缓冲区内剩余的数据包会按照”延迟惩罚值”从大到小的顺序被依次移出并进行处理。</p>
<p>例如，当数据包的”延迟惩罚值”依次是<5，3，1，2，4>，缓冲区大小K=2时，数据包被处理的顺序是：<5，3，2，4，1>。这时SP=1 * 5+2 * 3+3 * 2+4 * 4+5 * 1=38。</5，3，2，4，1></5，3，1，2，4></p>
<p>现在给定输入的数据包序列，以及一个总延迟惩罚阈值Q。小Hi想知道如果要SP&lt;=Q，缓冲区的大小最小是多少？</p>
<p>输入<br><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">Line</span> 1: <span class="keyword">N</span> <span class="literal">Q</span></span><br><span class="line"><span class="keyword">Line</span> 2: P1 P2 ... PN</span><br></pre></td></tr></table></figure></p>
<p>对于50%的数据： 1 &lt;= N &lt;= 1000</p>
<p>对于100%的数据： 1 &lt;= N &lt;= 100000, 0 &lt;= Pi &lt;= 1000, 1 &lt;= Q &lt;= 1013</p>
<p>输出<br>输出最小的正整数K值能满足SP&lt;=Q。如果没有符合条件的K，输出-1。</p>
<p>样例输入<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">5</span> <span class="number">38</span></span><br><span class="line"><span class="number">5</span> <span class="number">3</span> <span class="number">1</span> <span class="number">2</span> <span class="number">4</span></span><br></pre></td></tr></table></figure></p>
<p>样例输出<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>优先队列的问题。</p>
<p>然而只用优先队列是会超时的，应该使用二分查找——原因在于：对于缓冲区的大小K，随着K值的增大，延迟惩罚是个非递增序列（只可能不变或者下降，而不会递增）。</p>
<p>想到了优先队列但是没有想到二分……</p>
<p>AC代码：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;queue&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> LL long long</span></span><br><span class="line">priority_queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">LL Q,N,SP,K;</span><br><span class="line">LL nums[<span class="number">1000001</span>];</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function">LL <span class="title">cal</span><span class="params">(<span class="keyword">int</span> m)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	LL result = <span class="number">0</span>;</span><br><span class="line">	LL j = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (LL i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		q.push(nums[i]);</span><br><span class="line">		<span class="keyword">if</span> (q.size() == m)</span><br><span class="line">		&#123;</span><br><span class="line">			++j;</span><br><span class="line">			result += j * q.top();</span><br><span class="line">			q.pop();</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span> (q.size())</span><br><span class="line">	&#123;</span><br><span class="line">		++j;</span><br><span class="line">		result += j * q.top();</span><br><span class="line">		q.pop();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bin</span><span class="params">(LL s, LL e)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">while</span> (s &lt;= e)</span><br><span class="line">	&#123;</span><br><span class="line">		LL mid = (s + e) / <span class="number">2</span>;</span><br><span class="line">		SP = cal(mid);</span><br><span class="line">		<span class="keyword">if</span> (SP &gt; Q)</span><br><span class="line">		&#123;</span><br><span class="line">			s = mid + <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (mid &lt; K)</span><br><span class="line">			&#123;</span><br><span class="line">				K = mid;</span><br><span class="line">			&#125;</span><br><span class="line">			e = mid - <span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="built_in">cin</span> &gt;&gt; N &gt;&gt; Q;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; N; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">	    <span class="built_in">cin</span> &gt;&gt; nums[i];</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	K = N + <span class="number">1</span>;</span><br><span class="line">	bin(<span class="number">1</span>,N);</span><br><span class="line">	<span class="keyword">if</span> (K &lt;= N)</span><br><span class="line">	&#123;</span><br><span class="line">	    <span class="built_in">cout</span> &lt;&lt; K &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">	    <span class="built_in">cout</span> &lt;&lt; <span class="string">"-1"</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/09/九宫/" itemprop="url">
                  九宫
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-03-09T22:07:25+08:00" content="2016-03-09">
              2016-03-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OJs/" itemprop="url" rel="index">
                    <span itemprop="name">OJs</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="HiHoCoder_3A__u4E5D_u5BAB"><a href="#HiHoCoder_3A__u4E5D_u5BAB" class="headerlink" title="HiHoCoder: 九宫"></a><strong>HiHoCoder: 九宫</strong></h1><hr>
<p>From：<a href="http://hihocoder.com/contest/hihointerview3" target="_blank" rel="external">[Offer收割]编程练习赛1</a></p>
<blockquote>
<p>描述<br>小Hi最近在教邻居家的小朋友小学奥数，而最近正好讲述到了三阶幻方这个部分，三阶幻方指的是将1~9不重复的填入一个3*3的矩阵当中，使得每一行、每一列和每一条对角线的和都是相同的。</p>
<p>三阶幻方又被称作九宫格，在小学奥数里有一句非常有名的口诀：“二四为肩，六八为足，左三右七，戴九履一，五居其中”，通过这样的一句口诀就能够非常完美的构造出一个九宫格来。</p>
<p><img src="http://media.hihocoder.com//problem_images/20160305/14571898843687.png" alt="九宫"></p>
<p>有意思的是，所有的三阶幻方，都可以通过这样一个九宫格进行若干镜像和旋转操作之后得到。现在小Hi准备将一个三阶幻方（不一定是上图中的那个）中的一些数组抹掉，交给邻居家的小朋友来进行还原，并且希望她能够判断出究竟是不是只有一组解。</p>
<p>而你呢，也被小Hi交付了同样的任务，但是不同的是，你需要写一个程序~</p>
<p>输入<br>输入仅包含单组测试数据。</p>
<p>每组测试数据为一个3*3的矩阵，其中为0的部分表示被小Hi抹去的部分。</p>
<p>对于100%的数据，满足给出的矩阵至少能还原出一组可行的三阶幻方。</p>
<p>输出<br>如果仅能还原出一组可行的三阶幻方，则将其输出，否则输出“Too Many”（不包含引号）。</p>
<p>样例输入<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span> <span class="number">7</span> <span class="number">2</span></span><br><span class="line"><span class="number">0</span> <span class="number">5</span> <span class="number">0</span></span><br><span class="line"><span class="number">0</span> <span class="number">3</span> <span class="number">0</span></span><br></pre></td></tr></table></figure></p>
<p>样例输出<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">6</span> <span class="number">7</span> <span class="number">2</span></span><br><span class="line"><span class="number">1</span> <span class="number">5</span> <span class="number">9</span></span><br><span class="line"><span class="number">8</span> <span class="number">3</span> <span class="number">4</span></span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>使用回溯法进行求解。</p>
<p>还是做题少了，不够敏锐。知道用回溯的话写代码还好，一旦想偏就怎么也拉不回来了……</p>
<p>AC代码：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="preprocessor">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> Nine[<span class="number">9</span>];</span><br><span class="line"><span class="keyword">int</span> a, b, c;</span><br><span class="line"><span class="keyword">int</span>* addr = Nine;</span><br><span class="line"><span class="keyword">int</span> nums = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">int</span> o2nine[<span class="number">10</span>] = &#123; <span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span> &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> present[<span class="number">9</span>];</span><br><span class="line"></span><br><span class="line"><span class="preprocessor">#<span class="keyword">define</span> index(r,c) ((r) * (<span class="number">3</span>)+(c))</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">()</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> r = <span class="number">0</span>;</span><br><span class="line">	r = Nine[index(<span class="number">0</span>, <span class="number">0</span>)] + Nine[index(<span class="number">0</span>, <span class="number">1</span>)] + Nine[index(<span class="number">0</span>, <span class="number">2</span>)];</span><br><span class="line">	<span class="keyword">if</span> (r &gt; <span class="number">15</span>) <span class="keyword">return</span> <span class="literal">false</span>; r = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	r = Nine[index(<span class="number">1</span>, <span class="number">0</span>)] + Nine[index(<span class="number">1</span>, <span class="number">1</span>)] + Nine[index(<span class="number">1</span>, <span class="number">2</span>)];</span><br><span class="line">	<span class="keyword">if</span> (r &gt; <span class="number">15</span>) <span class="keyword">return</span> <span class="literal">false</span>; r = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	r = Nine[index(<span class="number">2</span>, <span class="number">0</span>)] + Nine[index(<span class="number">2</span>, <span class="number">1</span>)] + Nine[index(<span class="number">2</span>, <span class="number">2</span>)];</span><br><span class="line">	<span class="keyword">if</span> (r &gt; <span class="number">15</span>) <span class="keyword">return</span> <span class="literal">false</span>; r = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	r = Nine[index(<span class="number">0</span>, <span class="number">0</span>)] + Nine[index(<span class="number">1</span>, <span class="number">0</span>)] + Nine[index(<span class="number">2</span>, <span class="number">0</span>)];</span><br><span class="line">	<span class="keyword">if</span> (r &gt; <span class="number">15</span>) <span class="keyword">return</span> <span class="literal">false</span>; r = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	r = Nine[index(<span class="number">0</span>, <span class="number">1</span>)] + Nine[index(<span class="number">1</span>, <span class="number">1</span>)] + Nine[index(<span class="number">2</span>, <span class="number">1</span>)];</span><br><span class="line">	<span class="keyword">if</span> (r &gt; <span class="number">15</span>) <span class="keyword">return</span> <span class="literal">false</span>; r = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	r = Nine[index(<span class="number">0</span>, <span class="number">2</span>)] + Nine[index(<span class="number">1</span>, <span class="number">2</span>)] + Nine[index(<span class="number">2</span>, <span class="number">2</span>)];</span><br><span class="line">	<span class="keyword">if</span> (r &gt; <span class="number">15</span>) <span class="keyword">return</span> <span class="literal">false</span>; r = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	r = Nine[index(<span class="number">0</span>, <span class="number">0</span>)] + Nine[index(<span class="number">1</span>, <span class="number">1</span>)] + Nine[index(<span class="number">2</span>, <span class="number">2</span>)];</span><br><span class="line">	<span class="keyword">if</span> (r &gt; <span class="number">15</span>) <span class="keyword">return</span> <span class="literal">false</span>; r = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">	r = Nine[index(<span class="number">0</span>, <span class="number">2</span>)] + Nine[index(<span class="number">1</span>, <span class="number">1</span>)] + Nine[index(<span class="number">2</span>, <span class="number">0</span>)];</span><br><span class="line">	<span class="keyword">if</span> (r &gt; <span class="number">15</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">cal</span><span class="params">(<span class="keyword">int</span> x)</span></span><br><span class="line"></span>&#123;</span><br><span class="line">	<span class="keyword">bool</span> allZero = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span> (o2nine[i] != <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			allZero = <span class="literal">false</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (allZero)</span><br><span class="line">	&#123;</span><br><span class="line">		++nums;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">9</span>; ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			present[i] = Nine[i];</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">if</span> (Nine[x] == <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; <span class="number">10</span>; ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">if</span> (o2nine[i] != <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				Nine[x] = i;</span><br><span class="line">				o2nine[i] = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">if</span> (check())</span><br><span class="line">				&#123;</span><br><span class="line">					cal(x+<span class="number">1</span>);</span><br><span class="line">				&#125;</span><br><span class="line">				Nine[x] = <span class="number">0</span>;</span><br><span class="line">				o2nine[i] = i;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		cal(x+<span class="number">1</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span>** argv)</span></span><br><span class="line"></span>&#123;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cin</span> &gt;&gt; a &gt;&gt; b &gt;&gt; c;</span><br><span class="line">		addr[<span class="number">0</span>] = a;</span><br><span class="line">		addr[<span class="number">1</span>] = b;</span><br><span class="line">		addr[<span class="number">2</span>] = c;</span><br><span class="line">		addr += <span class="number">3</span>;</span><br><span class="line">		o2nine[a] = <span class="number">0</span>;</span><br><span class="line">		o2nine[b] = <span class="number">0</span>;</span><br><span class="line">		o2nine[c] = <span class="number">0</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	Nine[index(<span class="number">1</span>, <span class="number">1</span>)] = <span class="number">5</span>;</span><br><span class="line">	o2nine[<span class="number">5</span>] = <span class="number">0</span>;</span><br><span class="line">	cal(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span> (nums == <span class="number">1</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; ++i)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; ++j)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">cout</span> &lt;&lt; present[index(i, j)] &lt;&lt; <span class="string">" "</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">cout</span> &lt;&lt; endl;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">cout</span> &lt;&lt; <span class="string">"Too Many"</span> &lt;&lt; endl;</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/09/Spiral-Matrix-II/" itemprop="url">
                  Spiral Matrix II
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-03-09T19:09:29+08:00" content="2016-03-09">
              2016-03-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OJs/" itemprop="url" rel="index">
                    <span itemprop="name">OJs</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="Spiral_Matrix_II"><a href="#Spiral_Matrix_II" class="headerlink" title="Spiral Matrix II"></a><strong>Spiral Matrix II</strong></h1><hr>
<blockquote>
<p>Given an integer n, generate a square matrix filled with elements from 1 to n2 in spiral order.</p>
<p>For example,<br>Given n = 3,</p>
<p>You should return the following matrix:<br><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[</span><br><span class="line"> [ <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span> ],</span><br><span class="line"> [ <span class="number">8</span>, <span class="number">9</span>, <span class="number">4</span> ],</span><br><span class="line"> [ <span class="number">7</span>, <span class="number">6</span>, <span class="number">5</span> ]</span><br><span class="line">]</span><br></pre></td></tr></table></figure></p>
</blockquote>
<p>只需要控制好状态就行了。</p>
<p>AC代码：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">    <span class="keyword">struct</span> Runner</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">int</span> leftBorder;</span><br><span class="line">        <span class="keyword">int</span> rightBorder;</span><br><span class="line">        <span class="keyword">int</span> topBorder;</span><br><span class="line">        <span class="keyword">int</span> downBorder;</span><br><span class="line">        <span class="keyword">int</span> dir;</span><br><span class="line">        <span class="keyword">int</span> counter;</span><br><span class="line">        <span class="keyword">int</span> x;</span><br><span class="line">        <span class="keyword">int</span> y;</span><br><span class="line">        Runner(<span class="keyword">int</span> n)</span><br><span class="line">        &#123;</span><br><span class="line">            leftBorder = <span class="number">0</span>;</span><br><span class="line">            rightBorder = n;</span><br><span class="line">            topBorder = <span class="number">0</span>;</span><br><span class="line">            downBorder = n;</span><br><span class="line">            dir = <span class="number">1</span>;</span><br><span class="line">            counter = <span class="number">0</span>;</span><br><span class="line">            x = <span class="number">0</span>;</span><br><span class="line">            y = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">goRight</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; m, <span class="keyword">int</span> n, Runner&amp; r)</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r.x &lt; r.rightBorder)</span><br><span class="line">        &#123;</span><br><span class="line">            ++r.counter;</span><br><span class="line">            m[r.y][r.x] = r.counter;</span><br><span class="line">            ++r.x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            r.dir = <span class="number">2</span>;</span><br><span class="line">            ++r.topBorder;</span><br><span class="line">            ++r.y;</span><br><span class="line">            --r.x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">goLeft</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; m, <span class="keyword">int</span> n, Runner&amp; r)</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r.x &gt;= r.leftBorder)</span><br><span class="line">        &#123;</span><br><span class="line">            ++r.counter;</span><br><span class="line">            m[r.y][r.x] = r.counter;</span><br><span class="line">            --r.x;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            r.dir = <span class="number">3</span>;</span><br><span class="line">            --r.downBorder;</span><br><span class="line">            --r.y;</span><br><span class="line">            ++r.x;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">goDown</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; m, <span class="keyword">int</span> n, Runner&amp; r)</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r.y &lt; r.downBorder)</span><br><span class="line">        &#123;</span><br><span class="line">            ++r.counter;</span><br><span class="line">            m[r.y][r.x] = r.counter;</span><br><span class="line">            ++r.y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            r.dir = <span class="number">0</span>;</span><br><span class="line">            --r.rightBorder;</span><br><span class="line">            --r.x;</span><br><span class="line">            --r.y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">goUp</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; m, <span class="keyword">int</span> n, Runner&amp; r)</span></span><br><span class="line">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (r.y &gt;= r.topBorder)</span><br><span class="line">        &#123;</span><br><span class="line">            ++r.counter;</span><br><span class="line">            m[r.y][r.x] = r.counter;</span><br><span class="line">            --r.y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            r.dir = <span class="number">1</span>;</span><br><span class="line">            ++r.leftBorder;</span><br><span class="line">            ++r.x;</span><br><span class="line">            ++r.y;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; generateMatrix(<span class="keyword">int</span> n) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; result(n,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n,<span class="number">0</span>));</span><br><span class="line">        <span class="keyword">int</span> num = n * n;</span><br><span class="line">        <span class="function">Runner <span class="title">r</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="keyword">while</span>(r.counter &lt; num)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (r.dir == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                goLeft(result,n,r);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (r.dir == <span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                goRight(result,n,r);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (r.dir == <span class="number">2</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                goDown(result,n,r);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                goUp(result,n,r);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  
  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/03/09/Course-Schedule/" itemprop="url">
                  Course Schedule
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            发表于
            <time itemprop="dateCreated" datetime="2016-03-09T18:21:52+08:00" content="2016-03-09">
              2016-03-09
            </time>
          </span>

          
            <span class="post-category" >
              &nbsp; | &nbsp; 分类于
              
                <span itemprop="about" itemscope itemtype="https://schema.org/Thing">
                  <a href="/categories/OJs/" itemprop="url" rel="index">
                    <span itemprop="name">OJs</span>
                  </a>
                </span>

                
                

              
            </span>
          

          
            
          

          

        </div>
      </header>
    


    <div class="post-body">

      
      

      
        
          <span itemprop="articleBody">
            
              <h1 id="Course_Schedule"><a href="#Course_Schedule" class="headerlink" title="Course Schedule"></a><strong>Course Schedule</strong></h1><hr>
<blockquote>
<p>There are a total of n courses you have to take, labeled from 0 to n - 1.</p>
<p>Some courses may have prerequisites, for example to take course 0 you have to first take course 1, which is expressed as a pair: [0,1]</p>
<p>Given the total number of courses and a list of prerequisite pairs, is it possible for you to finish all courses?</p>
<p>For example:<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>, <span class="string">[[1,0]]</span></span><br></pre></td></tr></table></figure></p>
<p>There are a total of 2 courses to take. To take course 1 you should have finished course 0. So it is possible.<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">2</span>, [[<span class="number">1</span>,<span class="number">0</span>],[<span class="number">0</span>,<span class="number">1</span>]]</span><br></pre></td></tr></table></figure></p>
<p>There are a total of 2 courses to take. To take course 1 you should have finished course 0, and to take course 0 you should also have finished course 1. So it is impossible.</p>
</blockquote>
<p>依赖关系判定，实际上就是一个拓扑结构，层序遍历可解。BFS每下降一层，其对应后续节点的入度减一，入度为0的节点入队列，如果最后所有节点的入度都为0，则返回true，否则返回false。</p>
<p>AC的C++代码：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> Solution &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canFinish</span><span class="params">(<span class="keyword">int</span> numCourses, <span class="built_in">vector</span>&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt;&amp; prerequisites)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; graphic(numCourses,<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(<span class="number">0</span>));</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; indegrees(numCourses,<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">queue</span>&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> it = prerequisites.begin(); it != prerequisites.end(); ++it)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> succ = it-&gt;first;</span><br><span class="line">            <span class="keyword">int</span> pre = it-&gt;second;</span><br><span class="line">            indegrees[succ]++;</span><br><span class="line">            graphic[pre].push_back(succ);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; indegrees.size(); ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (indegrees[i] == <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                q.push(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(q.size())</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">int</span> n = q.front();</span><br><span class="line">            q.pop();<span class="comment">// 注意这里与C版本的顺序不一致。</span></span><br><span class="line">            <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; v = graphic[n];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; v.size(); ++i)</span><br><span class="line">            &#123;</span><br><span class="line">                --indegrees[v[i]];</span><br><span class="line">                <span class="keyword">if</span> (indegrees[v[i]] == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    q.push(v[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span> ; i &lt; indegrees.size(); ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (indegrees[i] != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></p>
<p>超过规定内存空间的C代码：<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">bool canFinish(int numCourses, int** prerequisites, int prerequisitesRowSize, int prerequisitesColSize) &#123;</span><br><span class="line">    int* indegrees = (int*)malloc(numCourses*sizeof(int));</span><br><span class="line">    int** graphic = (int**)malloc(sizeof(int*) * numCourses);</span><br><span class="line">    int * queue = (int*)malloc(numCourses*sizeof(int));</span><br><span class="line">    int begin = 0;</span><br><span class="line">    int end = 0;</span><br><span class="line">    for (int i = 0 ; i &lt; numCourses; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        indegrees[i] = 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (int i = 0 ; i &lt; numCourses; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        graphic[i] = (int*)malloc(sizeof(int*) * numCourses);</span><br><span class="line">        for (int j = 0 ; j &lt; numCourses; ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            graphic[i][j] = -1;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (int i = 0 ;i &lt; prerequisitesRowSize; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        int* row = prerequisites[i];</span><br><span class="line">        int succ = row[0];</span><br><span class="line">        int pre = row[1];</span><br><span class="line">        indegrees[succ]++;//后续课程入度加一</span><br><span class="line">        graphic[pre][succ] = 1;//设置前导课程的后续边</span><br><span class="line">    &#125;</span><br><span class="line">    //找出所有入度为0的点作为起始节点</span><br><span class="line">    for(int i = 0; i &lt; numCourses; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        if (indegrees[i] == 0)</span><br><span class="line">        &#123;</span><br><span class="line">            queue[end++] = i;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    // BFS</span><br><span class="line">    while(begin != end)</span><br><span class="line">    &#123;</span><br><span class="line">        int n = queue[begin];</span><br><span class="line">        //查找所有n的后继节点，每处理一次，后续节点入度减一，如果后续节点入度为0，那么就加入队列</span><br><span class="line">        for (int i = 0 ; i &lt; numCourses; ++i)</span><br><span class="line">        &#123;</span><br><span class="line">            if (graphic[n][i] == 1)</span><br><span class="line">            &#123;</span><br><span class="line">                --indegrees[i];</span><br><span class="line">                if (indegrees[i] == 0)</span><br><span class="line">                &#123;</span><br><span class="line">                    queue[end++] = i;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        ++begin;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //如果最后还有入度不为0的节点，返回false</span><br><span class="line">    for (int i = 0 ; i &lt; numCourses; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        if (indegrees[i] != 0)</span><br><span class="line">        &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return true;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

            
          </span>
        
      
    </div>

    <footer class="post-footer">
      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    

  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



        </div>

        


        

      </div>

      
        
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel  sidebar-panel-active ">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" src="/uploads/avatar.jpg" alt="SsCM" itemprop="image"/>
          <p class="site-author-name" itemprop="name">SsCM</p>
        </div>
        <p class="site-description motion-element" itemprop="description">希望以后心情不好的时候可以全世界遛遛弯</p>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">35</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          <div class="site-state-item site-state-categories">
            <a href="/categories">
              <span class="site-state-item-count">5</span>
              <span class="site-state-item-name">分类</span>
              </a>
          </div>

          <div class="site-state-item site-state-tags">
            <a href="/tags">
              <span class="site-state-item-count">27</span>
              <span class="site-state-item-name">标签</span>
              </a>
          </div>

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        <div class="links-of-author motion-element">
          
        </div>

      </section>

      

    </div>
  </aside>


      
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2016</span>
  <span class="with-love">
    <i class="icon-next-heart fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">SsCM</span>
</div>

<div class="powered-by">
  由 <a class="theme-link" href="http://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT
  </a>
</div>



      </div>
    </footer>

    <div class="back-to-top"></div>
  </div>

  <script type="text/javascript" src="/vendors/jquery/index.js?v=2.1.3"></script>

  
  

  
    
    

  


  

  
  <script type="text/javascript" src="/vendors/fancybox/source/jquery.fancybox.pack.js"></script>
  <script type="text/javascript" src="/js/fancy-box.js?v=0.4.5.2"></script>


  <script type="text/javascript" src="/js/helpers.js?v=0.4.5.2"></script>
  <script type="text/javascript" src="/vendors/velocity/velocity.min.js"></script>
<script type="text/javascript" src="/vendors/velocity/velocity.ui.min.js"></script>

<script type="text/javascript" src="/js/motion.js?v=0.4.5.2" id="motion.global"></script>


  <script type="text/javascript" src="/vendors/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  <script type="text/javascript" src="/vendors/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  

  <script type="text/javascript" src="/js/bootstrap.js"></script>

  
  
  <script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
  </script>

  <script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for (i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
      }
    });
  </script>

  
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/MathJax.js"></script>
    <script type="text/javascript" src="http://cdn.staticfile.org/mathjax/2.4.0/config/TeX-AMS-MML_HTMLorMML.js"></script>
  


  
  

</body>
</html>
